<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="refresh" content="5" />
    <title>Orbit Control Center</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @keyframes pulse-custom {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }
      .animate-pulse-custom {
        animation: pulse-custom 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }
    </style>
  </head>
  <body class="bg-gray-900 text-gray-300 font-mono antialiased p-6">
    <div class="max-w-7xl mx-auto">
      <header
        class="flex justify-between items-center border-b border-gray-700 pb-4 mb-8"
      >
        <h1 class="text-3xl text-blue-400 font-bold tracking-tight">
          üî≠ Orbit Control Center
        </h1>
        <a
          href="/config"
          class="text-sm bg-gray-800 hover:bg-gray-700 text-blue-400 px-3 py-1 rounded border border-gray-700 transition-colors"
        >
          ‚öôÔ∏è Config
        </a>
      </header>

      <!-- System Health -->
      <div
        class="bg-gray-800 border border-gray-700 rounded-lg p-6 mb-8 shadow-lg"
      >
        <h3 class="text-xl font-semibold text-gray-100 mb-4">System Health</h3>
        <div class="flex items-center space-x-4">
          <span class="text-gray-400">Load Average:</span>
          <span
            class="text-3xl font-bold {{if .Overloaded}}text-red-500{{else}}text-green-500{{end}}"
          >
            {{.Load}}
          </span>
        </div>
      </div>

      <!-- Mission Status -->
      <div
        class="bg-gray-800 border border-gray-700 rounded-lg shadow-lg overflow-hidden"
      >
        <div class="p-6 border-b border-gray-700">
          <h3 class="text-xl font-semibold text-gray-100">Mission Status</h3>
        </div>
        <div class="overflow-x-auto">
          <table class="w-full text-left">
            <thead class="bg-gray-800 text-gray-400 uppercase text-xs">
              <tr>
                <th class="px-6 py-3">Project</th>
                <th class="px-6 py-3">Current State</th>
                <th class="px-6 py-3">Last Result</th>
                <th class="px-6 py-3">Last Run</th>
                <th class="px-6 py-3">Action</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-700">
              {{range $name, $info := .Projects}}
              <tr class="hover:bg-gray-750 transition-colors">
                <td class="px-6 py-4 font-medium text-white">{{$name}}</td>

                <!-- State Column -->
                <td class="px-6 py-4">
                  {{if eq $info.StateClass "building"}} {{if eq $info.StateClass
                  "building"}}
                  <span
                    class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-900 text-yellow-200 animate-pulse-custom"
                  >
                    {{$info.Status}}
                  </span>
                  {{else if eq $info.StateClass "idle"}}
                  <span
                    class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-700 text-gray-300"
                  >
                    {{$info.Status}}
                  </span>
                  {{else}}
                  <span class="text-gray-300">{{$info.Status}}</span>
                  {{end}}
                </td>

                <!-- Result Column -->
                <td class="px-6 py-4">
                  {{if eq $info.ResultClass "success"}}
                  <span class="text-green-400 font-semibold">Success</span>
                  {{else if eq $info.ResultClass "failed"}}
                  <span class="text-red-400 font-semibold">Rollback</span>
                  {{else}}
                  <span class="text-gray-500">N/A</span>
                  {{end}}
                </td>

                <td class="px-6 py-4 text-gray-400 font-mono text-sm">
                  {{$info.TimeAgo}}
                </td>

                <td class="px-6 py-4">
                  <form action="/build" method="POST">
                    <input type="hidden" name="project" value="{{$name}}" />
                    <button
                      type="submit"
                      class="bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-1 px-3 rounded shadow hover:shadow-md transition-all active:scale-95"
                    >
                      üöÄ Build
                    </button>
                  </form>
                </td>
              </tr>
              {{end}}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </body>
</html>
